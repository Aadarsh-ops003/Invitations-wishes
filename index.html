<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Surprise 2026</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;600&display=swap" rel="stylesheet">
    <style>
        :root { --main-bg: #1a0026; --accent: #ff4d94; --text-color: #ffffff; --font-style: 'Poppins', sans-serif; }
        
        body, html { margin: 0; padding: 0; height: 100%; width: 100%; background: var(--main-bg); color: var(--text-color); font-family: var(--font-style); overflow: hidden; transition: all 1s ease; touch-action: none; }
        
        /* Auto Themes */
        .theme-propose { --main-bg: #2b0000; --accent: #ff0000; --font-style: 'Dancing Script', cursive; }
        .theme-anniversary { --main-bg: #1e003d; --accent: #e0b0ff; }
        .theme-festival { --main-bg: #261a00; --accent: #ffd700; }
        .theme-date { --main-bg: #1a0a00; --accent: #ff9f43; --font-style: 'Dancing Script', cursive; }

        #fireworks-canvas { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 999; }
        .screen { display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; min-height: 100vh; padding: 20px; box-sizing: border-box; }
        .active { display: flex; animation: fadeIn 0.8s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .heart { font-size: 80px; color: var(--accent); cursor: pointer; filter: drop-shadow(0 0 20px var(--accent)); transition: 0.3s; }
        .countdown-box { margin: 15px 0; font-size: 1.2rem; font-weight: bold; color: var(--accent); letter-spacing: 2px; }

        .card-stack { position: relative; width: 250px; height: 320px; margin: 20px auto; }
        .distraction-card, .gift-card { position: absolute; width: 100%; height: 100%; border-radius: 15px; display: flex; justify-content: center; align-items: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); transition: 0.5s; cursor: pointer; }
        .gift-card { background: var(--accent); color: white; flex-direction: column; }
        .fly-away { transform: translateX(200%) rotate(45deg); opacity: 0; pointer-events: none; }

        .golden-ticket { background: linear-gradient(45deg, #ffd700, #ffae00); color: #442c00; padding: 25px; border-radius: 15px; border: 4px dashed #442c00; }
        .claim-btn { background: #442c00; color: #ffd700; border: none; padding: 12px 25px; margin-top: 15px; font-weight: bold; cursor: pointer; border-radius: 50px; width: 100%; }

        .card-wrapper { perspective: 1000px; width: 280px; height: 350px; cursor: pointer; }
        .birthday-card { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: 1.2s; }
        .card-open { transform: rotateX(-140deg); }
        .card-front, .card-inside { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 10px; border: 3px solid var(--accent); background: white; color: #333; }
        .card-inside { transform: rotateX(180deg); padding: 20px; box-sizing: border-box; background: #fff0f3; display: flex; flex-direction: column; justify-content: center; text-align: center; }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 1001; justify-content: center; align-items: center; overflow-y: auto; }
        .modal-content { background: #1a1a1a; padding: 20px; border-radius: 20px; width: 90%; max-width: 380px; border: 1px solid var(--accent); }
        input, select { width: 90%; padding: 10px; margin: 8px 0; border-radius: 8px; border: none; background: #333; color: white; }
        .small-btn { font-size: 11px; color: #888; background: none; border: 1px solid #333; padding: 8px 20px; border-radius: 20px; cursor: pointer; margin-top: 30px; }
        
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</head>
<body onclick="createFirework(event)">

    <canvas id="fireworks-canvas"></canvas>

    <div id="screen1" class="screen active">
        <h2 style="font-size: 2.2rem;">Hey <span class="u-name"></span>!</h2>
        <div class="heart-container" id="heartBox" style="position:relative; width:100px; height:100px; margin:20px auto;">
            <div id="ring" style="position:absolute; top:0; left:0; width:100%; height:100%; border-radius:50%; border:4px solid transparent; border-top-color:var(--accent); display:none; animation:spin 1s linear infinite;"></div>
            <div class="heart" id="mainHeart">‚ù§Ô∏è</div>
        </div>
        <p>Tap & Hold the heart tightly...</p>
    </div>

    <div id="screen2" class="screen">
        <h2>Clear the distractions</h2>
        <div class="card-stack">
            <div class="gift-card" onclick="nextScreen(2, 3)">üéÅ<p>Unbox Now</p></div>
            <div class="distraction-card" style="background:#ff4757; color:white;" onclick="swipe(this)">Work Stress</div>
            <div class="distraction-card" style="background:#2f3542; color:white;" onclick="swipe(this)">Bad Vibes</div>
            <div class="distraction-card" style="background:#ffa502; color:white;" onclick="swipe(this)">Tensions</div>
        </div>
    </div>

    <div id="screen3" class="screen">
        <div class="golden-ticket">
            <h3 id="ticket-title">SPECIAL ACCESS</h3>
            <div class="countdown-box" id="timer-display">Ready for Surprise?</div>
            <p>For: <span class="u-name"></span></p>
            <button onclick="claim()" class="claim-btn">REVEAL SURPRISE ‚ú®</button>
        </div>
    </div>

    <div id="screen5" class="screen">
        <div class="card-wrapper" onclick="openCard()">
            <div class="birthday-card" id="bCard">
                <div class="card-front"><h3>For You üíå</h3><p>Tap to Read</p></div>
                <div class="card-inside">
                    <p id="displayMsg" style="font-size:1.2rem; line-height:1.5;"></p>
                </div>
            </div>
        </div>
        <button class="small-btn" onclick="toggleModal(true)">Create Your Own Surprise ‚úçÔ∏è</button>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <h3>Creator Studio</h3>
            <select id="inCat">
                <option value="birthday">Birthday üéÇ</option>
                <option value="propose">Propose üåπ</option>
                <option value="anniversary">Anniversary üíç</option>
                <option value="festival">Festival ‚ú®</option>
                <option value="date">Special Date ‚òï</option>
            </select>
            <input type="text" id="inName" placeholder="Recipient's Name">
            <input type="datetime-local" id="inTime">
            <button class="claim-btn" onclick="gen()">Generate & Copy Link</button>
            <div id="qrcode" style="margin-top:10px;"></div>
            <button class="small-btn" onclick="toggleModal(false)">Close</button>
        </div>
    </div>

    <script>
        const MONETAG = "https://otieu.com/4/10478983";
        const params = new URLSearchParams(window.location.search);
        
        const cat = params.get('c') || 'birthday';
        const name = params.get('n') || 'Special One';
        const eventTime = params.get('t') || '';

        // Apply Theme
        if(['propose', 'festival', 'anniversary', 'date'].includes(cat)) {
            document.body.classList.add('theme-' + cat);
        }

        document.querySelectorAll('.u-name').forEach(e => e.innerText = name);
        
        const wishes = {
            birthday: `Wishing you a day filled with endless joy and magic, ${name}! üéÇ`,
            propose: `Every heartbeat of mine whispers your name. Will you be mine forever? üåπ`,
            anniversary: `To the love that keeps growing every single day. Happy Anniversary! üíç`,
            festival: `Wishing you a glowing celebration filled with happiness! ‚ú®`,
            date: `I've been waiting for this... Let's make this date unforgettable. ‚òï`,
            invite: `Can't wait to celebrate with you! See you soon.`
        };
        document.getElementById('displayMsg').innerText = wishes[cat];

        // Countdown
        if(eventTime) {
            setInterval(() => {
                const distance = new Date(eventTime).getTime() - new Date().getTime();
                if (distance > 0) {
                    const d = Math.floor(distance / (1000 * 60 * 60 * 24));
                    const h = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const m = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                    document.getElementById('timer-display').innerText = `${d}d ${h}h ${m}m to go!`;
                }
            }, 1000);
        }

        // Functions
        function vibrate(ms) { if(navigator.vibrate) navigator.vibrate(ms); }
        function swipe(e) { vibrate(40); e.classList.add('fly-away'); }
        function openCard() { vibrate(60); document.getElementById('bCard').classList.toggle('card-open'); }
        function nextScreen(h, s) { document.getElementById('screen'+h).classList.remove('active'); document.getElementById('screen'+s).classList.add('active'); confetti(); }
        
        // Monetag Earning Logic
        function claim() { 
            vibrate(100); 
            window.open(MONETAG, '_blank'); 
            setTimeout(() => { nextScreen(3, 5); }, 500); 
        }

        function toggleModal(s) { document.getElementById('modal').style.display = s?'flex':'none'; }

        // Heart Hold Logic
        let hTimer, hInt;
        const hBox = document.getElementById('heartBox');
        hBox.onmousedown = hBox.ontouchstart = (e) => {
            e.preventDefault(); document.getElementById('ring').style.display='block';
            hInt = setInterval(()=>vibrate(50), 200);
            hTimer = setTimeout(()=> { clearInterval(hInt); nextScreen(1,2); }, 2000);
        };
        hBox.onmouseup = hBox.ontouchend = () => {
            document.getElementById('ring').style.display='none';
            clearInterval(hInt); clearTimeout(hTimer);
        };

        // Generator
        function gen() {
            const n = document.getElementById('inName').value || 'Friend';
            const c = document.getElementById('inCat').value;
            const t = document.getElementById('inTime').value;
            const url = `${window.location.origin}${window.location.pathname}?n=${encodeURIComponent(n)}&c=${c}&t=${encodeURIComponent(t)}`;
            
            document.getElementById('qrcode').innerHTML = "";
            new QRCode(document.getElementById('qrcode'), { text: url, width: 120, height: 120 });
            navigator.clipboard.writeText(url);
            vibrate([50, 50, 50]);
            alert("Surprise Link Copied!");
        }

        // Fireworks
        const canvas = document.getElementById('fireworks-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        let pArr = [];
        function createFirework(e) {
            vibrate(20);
            const x = e.clientX || (e.touches ? e.touches[0].clientX : 0);
            const y = e.clientY || (e.touches ? e.touches[0].clientY : 0);
            for(let i=0; i<15; i++) pArr.push({ x, y, dx:(Math.random()-0.5)*10, dy:(Math.random()-0.5)*10, l:60, c:`hsl(${Math.random()*360},100%,50%)` });
        }
        function anim() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            pArr.forEach((p, i) => {
                p.x += p.dx; p.y += p.dy; p.l--;
                ctx.fillStyle = p.c; ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, Math.PI*2); ctx.fill();
                if(p.l<=0) pArr.splice(i,1);
            });
            requestAnimationFrame(anim);
        }
        anim();
    </script>
</body>
</html>
